<!DOCTYPE html><html><head>
      <title>tutorial</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <h1 class="mume-header" id="4-skylabs-redux-workshops">#4 skylabs - Redux Workshops</h1>

<ul>
<li><a href="#three-principles">Three Principles</a></li>
<li><a href="#project-setup">Project setup</a></li>
<li><a href="#actions">Actions</a>
<ul>
<li><a href="#exercise-1">Exercise 1</a></li>
</ul>
</li>
<li><a href="#reducers">Reducers</a>
<ul>
<li><a href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
<li><a href="#combine-reducers">Combine reducers</a>
<ul>
<li><a href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
<li><a href="#store">Store</a>
<ul>
<li><a href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
<li><a href="#connecting-react-with-redux">Connecting React with Redux</a>
<ul>
<li><a href="#app-component">App Component</a></li>
<li><a href="#comment-component">Comment Component</a></li>
<li><a href="#commentslist-component">CommentsList component</a></li>
<li><a href="#exercise-5">Exercise 5</a></li>
</ul>
</li>
<li><a href="#redux-middleware">Redux Middleware</a>
<ul>
<li><a href="#redux-dev-tools">Redux Dev Tools</a></li>
</ul>
</li>
<li><a href="#creating-custom-middleware">Creating custom middleware</a></li>
</ul>
<h2 class="mume-header" id="three-principles">Three Principles</h2>

<p><strong>Redux</strong> can be described in three fundamental principles:</p>
<ul>
<li><strong>Single source of truth.</strong><br>
The state of your whole application is stored in an object tree within a single store.</li>
<li><strong>State is read-only.</strong><br>
The only way to change the state is to emit an action, an object describing what happened.</li>
<li><strong>Changes are made with pure functions</strong><br>
To specify how the state tree is transformed by actions, you write pure reducers.</li>
</ul>
<p>You must always keep in mind these the three principles of Redux.</p>
<p><a href="https://redux.js.org/introduction/three-principles">Click here for more info</a></p>
<h2 class="mume-header" id="project-setup">Project setup</h2>

<p>The playground will be an app for managing comments. There will be a possibility to add, delete, edit and vote for comments.</p>
<p>To create our skylab app, you may choose one of the following methods:</p>
<p><strong><em>npx</em></strong></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">npx create-react-app skylab-app
</pre><p><strong><em>npm</em></strong></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">npm</span> init react-app skylab-app
</pre><p><strong><em>Yarn</em></strong></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">yarn create react-app skylab-app
</pre><p>Now that our project is setup. In your terminal do the following:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">cd</span> skylabs-app
<span class="token function">npm</span> start
</pre><p>This should start our project on port <strong>3000</strong></p>
<p><img src="./images/image1.png" alt="(React App)"></p>
<p>So now we have our boilerplate app. Next, we need to clear the app structure, for that, you need to do the following</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">rm</span> src/App.* src/serviceWorker.js src/logo.svg
<span class="token keyword">echo</span> <span class="token string">&apos;&apos;</span> <span class="token operator">&gt;</span> src/index.js
<span class="token keyword">echo</span> <span class="token string">&apos;&apos;</span> <span class="token operator">&gt;</span> src/index.css
</pre><p>Before we start coding our app we need to install Redux. To do this type in terminal the following:</p>
<p>For <strong>npm</strong></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> redux react-redux
</pre><p>or if you use <strong>Yarn</strong></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">yarn add redux react-redux
</pre><p>Right now we can start hacking &#x1F609; our Redux app.</p>
<p><strong>App Component - App.js</strong></p>
<p>In folder <code>src</code> create a file <code>App.js</code> which will be containing the following code:</p>
<p><img src="./images/App.png" alt="App.js"></p>
<p><strong>Index.js</strong></p>
<p>Now let&apos;s create <code>index.js</code> file. It should be in folder <code>src</code>, too.</p>
<p><img src="./images/index-js.png" alt="index.js"></p>
<p>Now app looks like that:</p>
<p><img src="./images/basis-app.png" alt="Initial app view"></p>
<h2 class="mume-header" id="actions">Actions</h2>

<p>An <strong>action</strong> in Redux is a JavaScript object. It has a <strong>type</strong> and an optional <strong>payload</strong>. The type is often referred to as action type. While the type is a string literal, the payload can be anything from a string to an object.</p>
<p>In our case is an app for managing comments so we need actions, eg. add a comment. This action can look like this:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&quot;ADD_COMMENT&quot;</span><span class="token punctuation">,</span>
    payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        text<span class="token punctuation">:</span> <span class="token string">&quot;My first comment!&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Since strings are prone to typos and duplicates it&#x2019;s better to have action types declared as <em>constants</em>. This above action can look this:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token constant">ADD_COMMENT</span> <span class="token operator">=</span> <span class="token string">&apos;ADD_COMMENT&apos;</span><span class="token punctuation">;</span>

<span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">ADD_COMMENT</span><span class="token punctuation">,</span>
    payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        text<span class="token punctuation">:</span> <span class="token string">&quot;My first comment!&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>It is a best practice to wrap every action within a function. Such function is an <strong>action creator</strong>.</p>
<p>For above action the action creator can look this:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">addComment</span> <span class="token operator">=</span> text <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">ADD_COMMENT</span><span class="token punctuation">,</span>
  payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    text
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>For managing comments we need several types of actions: remove, edit a comment and for voting: thumb up and thumb down.</p>
<p>To remove comment we need know which comment should be removed. This can be done by passing comment&apos;s id to an action. The action object <code>REMOVE_COMMENT</code> will look like this:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&quot;REMOVE_COMMENT&quot;</span><span class="token punctuation">,</span>
    payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token comment">// id of an example comment</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Next edit comment. For successfully edit comment we need exactly know which comment and what is new content of the comment. So an action object should look like this:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token string">&quot;EDIT_COMMENT&quot;</span><span class="token punctuation">,</span>
    payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
        text<span class="token punctuation">:</span> <span class="token string">&quot;edited comment text!&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>With this knowledge, we can now make actions and action creators for the whole of our app. Let&apos;s do this!</p>
<p>Firstly in <code>src</code> create folder <code>actions</code> and in it create file <code>actions.js</code>.<br>
Then create constants for each action name (add, edit, remove, thumb up, thumb down).<br>
Here are the first three:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token constant">ADD_COMMENT</span> <span class="token operator">=</span> <span class="token string">&quot;ADD_COMMENT&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">REMOVE_COMMENT</span> <span class="token operator">=</span> <span class="token string">&quot;REMOVE_COMMENT&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">EDIT_COMMENT</span> <span class="token operator">=</span> <span class="token string">&quot;EDIT_COMMENT&quot;</span><span class="token punctuation">;</span>
</pre><p>Next step is making actions creator. As you know, action creator is a function that returns action object. Let&apos;s write it.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">let</span> commentID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">addComment</span> <span class="token operator">=</span> text <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token constant">ADD_COMMENT</span><span class="token punctuation">,</span>
  payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">:</span> commentID<span class="token operator">++</span><span class="token punctuation">,</span>
    text
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>*Note: <em>the variable <code>commentID</code> will store for us the next comment&apos;s id value</em>.</p>
<h3 class="mume-header" id="exercise-1">Exercise 1</h3>

<p>Based on the above write missing action types (vote up and vote down) and missing action creators.<br>
Don&apos;t forget to export each action and each action creator.</p>
<p><strong>Don&apos;t look below.</strong></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p><strong>Try your self!</strong></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p><strong>Good job!</strong> Right now your file should look similar to this.</p>
<p><img src="./images/actions-js.png" alt="actions.js"></p>
<h2 class="mume-header" id="reducers">Reducers</h2>

<p>A <strong>reducer</strong> is a <strong>pure function</strong>. It always produces the same output when the input stays the same. It has no <em>side-effects</em>, thus it is only an input/output operation. A reducer has two inputs: <em>current application&apos;s state and action</em>. The state is always the global state object from the Redux store. The action is the dispatched action with a type and optional payload. The reducer reduces - that explains the naming - the previous state and incoming action to a new state.</p>
<p>Before we start writing our reducers function we need to think about how the state&apos;s structure of our app should look. Keep in mind that this structure should be as flat as possible. Our app is a simple case, comments are anonymous so we have only a comment&apos;s list - the state structure is an array with comments.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token punctuation">{</span>
  comments<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      text<span class="token punctuation">:</span> <span class="token string">&quot;This is the first comment!&quot;</span><span class="token punctuation">,</span>
      votes<span class="token punctuation">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      text<span class="token punctuation">:</span> <span class="token string">&quot;Another comment.&quot;</span><span class="token punctuation">,</span>
      votes<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</pre><p>But...<br>
If comments will be related to a user, the state structure can look like this:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token punctuation">{</span>
  comments<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      userId<span class="token punctuation">:</span> <span class="token string">&quot;123aba345&quot;</span><span class="token punctuation">,</span>
      text<span class="token punctuation">:</span> <span class="token string">&quot;This is the first comment!&quot;</span><span class="token punctuation">,</span>
      votes<span class="token punctuation">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      userId<span class="token punctuation">:</span> <span class="token string">&quot;987cad654&quot;</span><span class="token punctuation">,</span>
      text<span class="token punctuation">:</span> <span class="token string">&quot;Another comment.&quot;</span><span class="token punctuation">,</span>
      votes<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  users<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      id<span class="token punctuation">:</span> <span class="token string">&quot;123aba345&quot;</span><span class="token punctuation">,</span>
      firstName<span class="token punctuation">:</span> <span class="token string">&apos;John&apos;</span><span class="token punctuation">,</span>
      lastName<span class="token punctuation">:</span> <span class="token string">&apos;Smith&apos;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</pre><p>Time to write the first reducer.</p>
<p>In <code>src</code> create folder <code>reducers</code>. In this folder create file <code>reducers.js</code>.</p>
<p>As you know, reducer on the input gets a current state. But... What if our app just start and there is no current state yet? For this case, we prepare <code>initialState</code> variable.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span>
  comments<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  user<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Thanks to ES6 syntax - default argument - in the reducer function we can handle the initial application state in a simple way.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>So we have done handling the initial application state. It&apos;s time to handle actions.</p>
<p>The reducer calculates the new state depending on the action type. Moreover, it should return at least the current state when no action type matches. When the action type matches a valid clause the reducer calculates the new state and returns a new object.</p>
<p>In JavaScript, a <strong>switch case</strong> can help to evaluate different action types. Otherwise, it returns the previous state as default.</p>
<p>Let&apos;s start with the add comment action.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_COMMENT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        comments<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            id<span class="token punctuation">:</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
            text<span class="token punctuation">:</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
            votes<span class="token punctuation">:</span> <span class="token number">0</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token operator">...</span>state<span class="token punctuation">.</span>comments
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>But...<br>
The reducer doesn&apos;t know what is <code>ADD_COMMENT</code>, because all our actions types are defined in file <code>actions.js</code>. There are exported, too. Time to import this action on the top of the reducer file.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">ADD_COMMENT</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../actions/actions&quot;</span><span class="token punctuation">;</span>
</pre><p>So the first change of app state is handled.</p>
<p>The case that needs more effort on the first sight is the remove comment action. The new state should contain a comments list (array) without the one removed comment. But...</p>
<p>With <code>Array.filter()</code> method - it will be easy. All that we need to do is filter the current comments list and return all comments with <em>id</em> different than removed one.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_COMMENT</span><span class="token punctuation">:</span>
      <span class="token operator">...</span>
    <span class="token keyword">case</span> <span class="token constant">REMOVE_COMMENT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        comments<span class="token punctuation">:</span> state<span class="token punctuation">.</span>comments<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>comment <span class="token operator">=&gt;</span> comment<span class="token punctuation">.</span>id <span class="token operator">!==</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="exercise-2">Exercise 2</h3>

<p>The goal is to write code for handling all other actions (edit, vote). Note that voting is two different actions (<code>VOTE_UP_COMMENT</code> and <code>VOTE_DOWN_COMMENT</code>). Remember to import all of the actions.</p>
<p><strong>Don&apos;t look below.</strong></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p><strong>Try your self!</strong></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p><strong>Good job!</strong> Right now your file should looks similar to this.</p>
<p><img src="./images/reducers-js.png" alt="reducers.js"></p>
<h2 class="mume-header" id="combine-reducers">Combine reducers</h2>

<p>Our app state is combined from two small states: <code>comments</code> and <code>users</code>. When you look closer to the reducers function, you can see that for each comment action we are taking the whole state of the app. This no looks pretty and need from us more work. So because the comments state is not related with the user state the best practice is to extract them to separated files.</p>
<p>Let&apos;s do this for the comment&apos;s reducer.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">commentsReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">ADD_COMMENT</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          id<span class="token punctuation">:</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
          text<span class="token punctuation">:</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>text<span class="token punctuation">,</span>
          votes<span class="token punctuation">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">...</span>state
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>As you can see, now the initial state is an empty array. We don&apos;t need to care about the whole state of the app. Our new reducer will handle only the part of the app state that is related to comments. Handling small parts of data is always easier and makes code cleaner. Our new reducer returns a new array of comments - there is no mutation and it is a pure function - so we don&apos;t break any of the three Redux principles.</p>
<p>Ok, we have our new separated reducers. Time to merging them into one the root reducer. The Redux has a helper function called <code>combineReducers</code> that help us to merge reducer into one reducer. It can look like this below:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> combineReducers <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> commentsReducer <span class="token keyword">from</span> <span class="token string">&quot;./commentsReducer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> usersReducer <span class="token keyword">from</span> <span class="token string">&quot;./usersReducer&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> rootReducer <span class="token operator">=</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  comments<span class="token punctuation">:</span> commentsReducer<span class="token punctuation">,</span>
  users<span class="token punctuation">:</span> usersReducer
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><h3 class="mume-header" id="exercise-3">Exercise 3</h3>

<p>Your goal is to refactor file <code>reducers.js</code> that will import the extracted <strong>comments</strong> reducer (it should be in a separated file called <code>commentsReducer.js</code>). Don&apos;t waste your time for the users&apos; reducer file - we don&apos;t create any action for users state - so you can just return the unchanged user state in it.</p>
<p><strong>Don&apos;t look below.</strong></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p><strong>Try your self!</strong></p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p>&#xA0;</p>
<p><strong>Good job!</strong> Right now your files should looks similar to these:</p>
<p><code>commentsReducer.js</code><br>
<img src="./images/commentsReducer.png" alt="Comments reducer"></p>
<p><code>usersReducer.js</code><br>
<img src="./images/usersReducer.png" alt="Users reducer"></p>
<p><code>rootReducer.js</code><br>
<img src="./images/rootReducer.png" alt="Root reducer"></p>
<h2 class="mume-header" id="store">Store</h2>

<p>What is Redux Store? The store is an object that holds the whole state of our application. It&apos;s a place that &apos;glues&apos; actions and reducers. There should be only one store in Redux application. The only way to change the state inside it is to dispatch an action on it.</p>
<p>Let&apos;s create our store. For this, use a function <code>createStore()</code>. This function takes as the first argument the higher orderer reducer (this one which is not composed with others). In our app it&apos;s <code>rootReducer</code>. Note that function createStore as the second argument (optional) takes preloaded state of store. It can be usefully in eg. to hydrate the state from server.</p>
<p>In the folder <code>src/store</code> create file <code>store.js</code></p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> rootReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../reducers/rootReducer&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</pre><p>Yeah! That it&apos;s! Our store is created!</p>
<p>Redux itself is a small library about 2KB. The Redux store exposes a simple API for managing the state. The most important methods are:</p>
<ul>
<li><code>getState</code> for accessing the current state of the application</li>
<li><code>dispatch</code> for dispatching an action</li>
<li><code>subscribe</code> for listening on state changes</li>
</ul>
<p>Time to play with them. We will play in the browser&apos;s console.</p>
<p>So we need to export as global variables the store and the actions we have created earlier. Open file <code>src/index.js</code> and delete all from it. Update it with the following code:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> store <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./store/store&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> addComment<span class="token punctuation">,</span> voteUpComment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./actions/actions&quot;</span><span class="token punctuation">;</span>

window<span class="token punctuation">.</span>store <span class="token operator">=</span> store<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>addComment <span class="token operator">=</span> addComment<span class="token punctuation">;</span>
window<span class="token punctuation">.</span>voteUpComment <span class="token operator">=</span> voteUpComment<span class="token punctuation">;</span>
</pre><p>Now run dev server with:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">npm</span> start
</pre><p>Head over <a href="http://localhost:3000">http://localhost:3000</a> and open up the console with F12.</p>
<p>We&apos;ve exported the store as a global variable so we can access its methods. Let&apos;s try!</p>
<p>The first - accessing current state.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>output:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token punctuation">{</span>comments: Array<span class="token punctuation">(</span>0<span class="token punctuation">)</span>, users: Array<span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">}</span>
</pre><p>Zero comments, zero users. Indeed! We haven&apos;t update the initial state yet.</p>
<p>The interesting thing is that we can listen to state updates with <strong>subscribe</strong>.</p>
<p>The subscribe method accepts a callback that will call whenever an action is dispatched. Dispatching an action means notifying the store that we want to change the state.</p>
<p>Let&apos;s register a callback!</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Yeah! It&apos;s Redux!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The only way to change state in Redux is dispatching an action. To do this you need to call the <strong>dispatch</strong> method. We have only one action on our disposal: <code>addComment()</code> for adding a new comment to the state.</p>
<p>Let&#x2019;s dispatch the action with:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addComment</span><span class="token punctuation">(</span><span class="token string">&quot;New Comment!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>After you hit Enter key you should see:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">Yeah<span class="token operator">!</span> It&apos;s Redux<span class="token operator">!</span>
<span class="token punctuation">{</span>type: <span class="token string">&quot;ADD_COMMENT&quot;</span>, payload: <span class="token punctuation">{</span>&#x2026;<span class="token punctuation">}</span><span class="token punctuation">}</span>
</pre><p>To verify that the state changed run again:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Now the output should be:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token punctuation">{</span>comments: Array<span class="token punctuation">(</span>1<span class="token punctuation">)</span>, users: Array<span class="token punctuation">(</span>0<span class="token punctuation">)</span><span class="token punctuation">}</span>
</pre><p>And that&apos;s all!</p>
<p>Simply - the Redux!</p>
<h3 class="mume-header" id="exercise-4">Exercise 4</h3>

<p>Explore these three methods as an exercise. Add more actions and play with them in the browser&apos;s console.</p>
<h2 class="mume-header" id="connecting-react-with-redux">Connecting React with Redux</h2>

<p>Redux is framework agnostic. It can be used with vanilla JS. Or with Angular. Or with React. There are many bindings that can join Redux together with your favorite framework. For React is <strong>react-redux</strong>. You can install it by using:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> react-redux
</pre><p>The react-redux package exposes a very simple interface, and all you should be interested in is just the following:</p>
<ul>
<li><strong>&lt;Provider store&gt;</strong> - wraps the React application and makes the Redux state available to all container components in the application&#x2019;s hierarchy</li>
<li><strong>connect([mapStateToProps], [mapDispatchToProps], [mergeProps], [options])</strong>&#x200A; - &#x200A;creates a higher-order component for making container components out of base React components</li>
</ul>
<p>The fundamental things to know are:</p>
<ul>
<li>the mapStateToProps function</li>
<li>the mapDispatchToProps function or object</li>
</ul>
<p><strong>mapStateToProps</strong> does exactly what its name suggests: it connects a part of the Redux state to the props of a React component.</p>
<p><strong>mapDispatchToProps</strong> does something similar, but for actions. mapDispatchToProps connects Redux actions to React props.</p>
<p>To start connecting Redux with React we&#x2019;re going to use Provider in <code>src/index.js</code>. Provider is a high order component coming from react-redux - it wraps up React app and makes available to it the entire Redux&#x2019;s store.</p>
<p><img src="./images/index-with-provider.png" alt="index.js with Provider"></p>
<h3 class="mume-header" id="app-component">App Component</h3>

<p>Our app component should look like this:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;App&quot;</span><span class="token operator">&gt;</span>Here will a list <span class="token keyword">of</span> comments<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</pre><p>You need to change the file name (exactly extension) for <code>App.jsx</code>. For now it&apos;s enough, we return to this component later.</p>
<h3 class="mume-header" id="comment-component">Comment Component</h3>

<p>This component will be responsible for displaying a single comment in the CommentsList component. Create a folder <code>scr/components</code>. Then create a file <code>Comment.jsx</code>.</p>
<p><img src="./images/comment-1.png" alt="Comment component code"></p>
<p>As you can see it&apos;s very simple. Zero logic. Only presentation. That&apos;s what exactly should the component do.</p>
<h3 class="mume-header" id="commentslist-component">CommentsList component</h3>

<p>In this component, we&apos;ll be displaying all of the comments using created earlier Comments component.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Comment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./Comment&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">CommentsListRaw</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> comments <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>comments<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>comment <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>Comment key<span class="token operator">=</span><span class="token punctuation">{</span>comment<span class="token punctuation">.</span>id<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span>comment<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Time to connect our React component to the Redux store. We will use the react-redux method <code>connect</code>. We need to import it. Add the following import:</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-redux&quot;</span><span class="token punctuation">;</span>
</pre><p>Now we need to pass the part of app state related with comments list to the component.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> state <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  comments<span class="token punctuation">:</span> state<span class="token punctuation">.</span>comments
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> CommentsList <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>CommentsListRaw<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>The function <strong>mapStateToProps</strong> on input gets the app state and on output returns an object with the specified part of the app state. In our case, the specified part of app state is <code>state.comments</code>. It will be passed to the component CommentList as its props <code>comments</code> using the function <code>connect</code>.</p>
<p>Let&apos;s return to App component and update it.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CommentsList <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./components/CommentsList&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>CommentsList <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</pre><p>**Time to make small test. In the file <code>index.js</code> import an action creator <code>addComment</code>. Then on the bottom of the file (below ReactDOM.render() method) put these two lines.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript">store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addComment</span><span class="token punctuation">(</span><span class="token string">&quot;The first comment!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addComment</span><span class="token punctuation">(</span><span class="token string">&quot;The second comment!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>Yeah! It&apos;s kind of a hardcode, but if you have done all things properly you should see something like this:</p>
<p><img src="./images/app-screenshot1.png" alt="App screenshot"></p>
<p>Now we will try to connect an action to component. Let&apos;s do for voting up.</p>
<p>Go back to <code>Comments.jsx</code>. As in CommentsList component we need to import <code>connect</code> method from <em>react-redux</em>. We need to import an action creator for voting up. It will be <code>voteUpComment</code>.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-redux&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> voteUpComment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../actions/actions&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">CommentRaw</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> text<span class="token punctuation">,</span> votes<span class="token punctuation">,</span> id<span class="token punctuation">,</span> voteUpComment <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>text<span class="token punctuation">}</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>votes<span class="token punctuation">:</span> <span class="token punctuation">{</span>votes<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">voteUpComment</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>Vote Up<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> Comment <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> voteUpComment <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span>CommentRaw<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>As you can see we do some refactoring. We change the name of the base component and add a button for voting up. The last thing we need to do is dispatch the action to the store. As earlier, we use <code>connect</code>, but this time we don&apos;t pass any state to props so the first argument is null. The second one is an object with our action creators that we pass to the component.</p>
<p><img src="./images/app-screenshot2.png" alt="App screenshot"></p>
<h3 class="mume-header" id="exercise-5">Exercise 5</h3>

<p>Time to own work.</p>
<p>Add an opposite feature to the voting up. If you want you can add a feature for delete a comment or even a feature for add a comment.</p>
<p><strong>NOTE!</strong> So if everything is OK, remove this added code **</p>
<h2 class="mume-header" id="redux-middleware">Redux Middleware</h2>

<p><strong>What is Redux Middleware?</strong></p>
<p>A Redux middleware is a function that is able to intercept, and act accordingly, our actions, before they reach the reducer. And while the theory is quite simple, a Redux middleware can look a bit confusing. In its basic form a Redux middleware is a function returning a function, which takes next as a parameter. Then the inner function returns another function which takes action as a parameter and finally returns next(action).</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">function</span> <span class="token function">exampleMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// do your stuff</span>
      <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>In most case middleware is additional software that we often download as packages. It is fired between the moment in which we dispatch the action and the moment in which the reducer receives it. As well we can write our own middleware.</p>
<h3 class="mume-header" id="redux-dev-tools">Redux Dev Tools</h3>

<p>Redux Dev Tools is a tool that helps us in development time to inspect which and when actions were fired, helps to delete action and more...</p>
<p>If you don&apos;t have installed Redux Dev Tools yet, please go <a href="https://extension.remotedev.io/#installation">here</a> and install depends on your internet browser.</p>
<p>Now, we update the store file.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> rootReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../reducers/rootReducer&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>rootReducer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
  rootReducer<span class="token punctuation">,</span>
  window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION__ <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span><span class="token function">__REDUX_DEVTOOLS_EXTENSION__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</pre><p>Now we can inspect our app.</p>
<p><img src="./images/ReduxDevTools.png" alt="ReduxDevTools"></p>
<h2 class="mume-header" id="creating-custom-middleware">Creating custom middleware</h2>

<p>Middleware can be custom function too. We can create own middleware. Let&apos;s do this.</p>
<p>Our middleware will be checking if the new comment that is adding contain any word from the list of forbidden words. When it contains we will dispatch an action &quot;FOUND_BAD_WORD&quot;.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">ADD_COMMENT</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../actions/actions&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> forbiddenWords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;hate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;php&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">forbiddenWordsMiddleware</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> next <span class="token operator">=&gt;</span> action <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">ADD_COMMENT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> foundWord <span class="token operator">=</span> forbiddenWords<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>word <span class="token operator">=&gt;</span>
        action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>foundWord<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">&quot;FOUND_BAD_WORD&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre><p>Yeah! It&apos;s simple middleware but you can see how it works. There&apos;s one step to do before we can use them. We need to update our Redux store. Because we want to use our custom middleware together with the Redux Dev Tools we need to use utility <code>applyMiddleware</code>.</p>
<pre data-role="codeBlock" data-info="javascript" class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware<span class="token punctuation">,</span> compose <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> rootReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../reducers/rootReducer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> forbiddenWordsMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../middleware/forbiddenWordsMiddleware&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> composeEnhancers <span class="token operator">=</span> window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ <span class="token operator">||</span> compose<span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>
  rootReducer<span class="token punctuation">,</span>
  <span class="token function">composeEnhancers</span><span class="token punctuation">(</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>forbiddenWordsMiddleware<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</pre><p>After trying add comment with one of the forbidden words it can look like this in the dev tools:</p>
<p><img src="./images/app-screenshot3.png" alt="App screenshot"></p>

      </div>











    </body></html>